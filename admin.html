<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>CANDY ADMIN</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #050505; --card: rgba(255,255,255,0.03); --pink: #ff00cc; --border: rgba(255,255,255,0.1); }
    body { background: var(--bg); color: #fff; font-family: 'Outfit', sans-serif; padding: 20px; }
    #loginOverlay { position: fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:99; display:flex; align-items:center; justify-content:center; }
    .grid { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }
    .card { background: var(--card); border: 1px solid var(--border); padding: 20px; border-radius: 15px; }
    input, textarea { width: 100%; padding: 10px; margin-bottom: 10px; background: rgba(255,255,255,0.05); border: 1px solid var(--border); border-radius: 8px; color: #fff; }
    .btn { padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; background: var(--pink); color: #fff; text-transform: uppercase; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.8rem; }
    th, td { padding: 10px; border-bottom: 1px solid var(--border); text-align: left; }
    .img-prev { width: 50px; height: 50px; object-fit: cover; border-radius: 5px; background: #000; display: block; margin-bottom: 10px; border: 1px solid var(--border); }
  </style>
</head>
<body>
  <div id="loginOverlay"><div class="card"><h2>LOGIN</h2><input type="password" id="pass" placeholder="Has≈Ço"><button class="btn" onclick="login()">Zaloguj</button></div></div>
  
  <div id="adminContent" style="display:none; max-width: 1200px; margin: 0 auto;">
    <h1 style="margin-bottom:20px;">Admin Panel</h1>
    <div class="grid">
      <div class="card">
        <h3 id="formT">Dodaj Produkt</h3>
        <input type="hidden" id="editIdx" value="-1">
        <input type="text" id="pN" placeholder="Nazwa">
        <input type="text" id="pP" placeholder="Cena">
        <input type="text" id="pT" placeholder="Typ (np. Brainrot)">
        <input type="text" id="pR" placeholder="Rarity (np. Secret)">
        <input type="text" id="pDel" placeholder="Dostawa (np. ~20 min)">
        <textarea id="pD" placeholder="Opis..."></textarea>
        <label style="font-size:0.7rem;">ZDJƒòCIE:</label>
        <img id="pPreview" class="img-prev" src="">
        <input type="file" id="pFile" accept="image/*" onchange="convert()">
        <button class="btn" onclick="save()">Zapisz Produkt</button>
      </div>
      <div class="card">
        <h3>Produkty</h3>
        <table id="pList"></table>
      </div>
      <div class="card" style="grid-column: 1/-1;">
        <h3>Zam√≥wienia</h3>
        <table id="oList"></table>
      </div>
    </div>
  </div>

  <script>
    let currentImg = "";
    function login() { if(document.getElementById('pass').value === "admin") { document.getElementById('loginOverlay').style.display='none'; document.getElementById('adminContent').style.display='block'; render(); } }
    
    function convert() {
      const reader = new FileReader();
      reader.onload = e => { currentImg = e.target.result; document.getElementById('pPreview').src = currentImg; };
      reader.readAsDataURL(document.getElementById('pFile').files[0]);
    }

    function save() {
      const idx = document.getElementById('editIdx').value;
      let items = JSON.parse(localStorage.getItem('candyProducts')) || [];
      const data = { 
        name: document.getElementById('pN').value, price: document.getElementById('pP').value, 
        type: document.getElementById('pT').value, rarity: document.getElementById('pR').value, 
        delivery: document.getElementById('pDel').value, desc: document.getElementById('pD').value, 
        img: currentImg || (idx != -1 ? items[idx].img : "") 
      };
      if(idx == -1) items.push(data); else items[idx] = data;
      localStorage.setItem('candyProducts', JSON.stringify(items));
      location.reload();
    }

    function render() {
      const ps = JSON.parse(localStorage.getItem('candyProducts')) || [];
      let hP = "<tr><th>Foto</th><th>Nazwa</th><th>Opcje</th></tr>";
      ps.forEach((p, i) => { hP += `<tr><td><img src="${p.img}" style="width:30px"></td><td>${p.name}</td><td><button onclick="edit(${i})">‚úèÔ∏è</button><button onclick="del(${i},'p')">üóëÔ∏è</button></td></tr>`; });
      document.getElementById('pList').innerHTML = hP;

      const os = JSON.parse(localStorage.getItem('candyOrders')) || [];
      let hO = "<tr><th>Data</th><th>Klient</th><th>Produkt</th><th>Akcja</th></tr>";
      os.forEach((o, i) => { hO += `<tr><td>${o.date}</td><td>${o.customer}</td><td>${o.product}</td><td><button onclick="del(${i},'o')">Usu≈Ñ</button></td></tr>`; });
      document.getElementById('oList').innerHTML = hO;
    }

    function edit(i) {
      const items = JSON.parse(localStorage.getItem('candyProducts'));
      const p = items[i];
      document.getElementById('editIdx').value = i;
      document.getElementById('pN').value = p.name;
      document.getElementById('pP').value = p.price;
      document.getElementById('pT').value = p.type || "";
      document.getElementById('pR').value = p.rarity || "";
      document.getElementById('pDel').value = p.delivery || "";
      document.getElementById('pD').value = p.desc;
      document.getElementById('pPreview').src = p.img;
      document.getElementById('formT').innerText = "Edytuj";
    }

    function del(i, t) {
      let k = t == 'p' ? 'candyProducts' : 'candyOrders';
      let items = JSON.parse(localStorage.getItem(k));
      items.splice(i, 1);
      localStorage.setItem(k, JSON.stringify(items));
      render();
    }
  </script>
</body>
</html>
