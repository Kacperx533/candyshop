<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>CANDY ADMIN | ZarzƒÖdzanie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #050505; --card: rgba(255,255,255,0.03); --pink: #ff00cc; --cyan: #00dbde; --border: rgba(255,255,255,0.1); }
    body { background: var(--bg); color: #fff; font-family: 'Outfit', sans-serif; padding: 20px; }
    #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 9999; display: flex; align-items: center; justify-content: center; }
    .box { background: var(--card); border: 1px solid var(--border); padding: 30px; border-radius: 20px; backdrop-filter: blur(20px); }
    #adminContent { display: none; max-width: 1200px; margin: 0 auto; }
    .grid { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }
    .card { background: var(--card); border: 1px solid var(--border); padding: 20px; border-radius: 15px; }
    input, textarea { width: 100%; padding: 10px; margin-bottom: 10px; background: rgba(255,255,255,0.05); border: 1px solid var(--border); border-radius: 8px; color: #fff; }
    .btn { padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; text-transform: uppercase; width: 100%; transition: 0.3s; }
    .btn-pink { background: var(--pink); color: #fff; }
    .btn-outline { background: transparent; border: 1px solid #444; color: #888; margin-top: 5px; }
    table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
    th { text-align: left; padding: 10px; border-bottom: 2px solid var(--border); color: #888; }
    td { padding: 10px; border-bottom: 1px solid var(--border); }
    .img-p { width: 35px; height: 35px; border-radius: 5px; object-fit: cover; }
    .stats { display: flex; gap: 15px; margin-bottom: 20px; }
    .stat { flex: 1; background: var(--card); padding: 15px; border-radius: 10px; text-align: center; border: 1px solid var(--border); }
    .search-box { margin-bottom: 20px; width: 100%; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div id="loginOverlay"><div class="box"><h2>ADMIN LOGIN</h2><input type="password" id="p" placeholder="Has≈Ço"><button class="btn btn-pink" onclick="login()">Zaloguj</button></div></div>
  <div id="adminContent">
    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
      <h1>ZarzƒÖdzanie Sklepem</h1>
      <div><button class="btn btn-outline" style="width:auto;" onclick="exportData()">üíæ Kopia</button><button class="btn btn-outline" style="width:auto;" onclick="logout()">Wyloguj</button></div>
    </div>
    <div class="stats"><div class="stat"><small>Produkty</small><div id="s1" style="font-size:1.5rem; font-weight:900;">0</div></div><div class="stat"><small>Zam√≥wienia</small><div id="s2" style="font-size:1.5rem; font-weight:900; color:var(--pink);">0</div></div></div>
    <input type="text" class="search-box" id="search" placeholder="Szukaj zam√≥wienia lub produktu..." onkeyup="render()">
    <div class="grid">
      <div class="card">
        <h3 id="formT">Dodaj Produkt</h3>
        <input type="hidden" id="editIdx" value="-1">
        <input type="text" id="pN" placeholder="Nazwa">
        <input type="text" id="pP" placeholder="Cena">
        <textarea id="pD" placeholder="Opis..."></textarea>
        <input type="text" id="pI" placeholder="URL Zdjƒôcia">
        <button class="btn btn-pink" onclick="save()">Zapisz</button>
      </div>
      <div class="card"><h3>Lista Produkt√≥w</h3><div style="overflow-x:auto;"><table><thead><tr><th>Foto</th><th>Nazwa</th><th>Opcje</th></tr></thead><tbody id="pList"></tbody></table></div></div>
      <div class="card" style="grid-column: 1 / -1;"><h3>Zam√≥wienia</h3><div style="overflow-x:auto;"><table><thead><tr><th>Data</th><th>Klient</th><th>Produkt</th><th>Wiadomo≈õƒá</th><th>Akcja</th></tr></thead><tbody id="oList"></tbody></table></div></div>
    </div>
  </div>
  <script>
    const PASS = "admin"; // Has≈Ço
    function login() { if(document.getElementById('p').value === PASS) { sessionStorage.setItem('l', '1'); show(); } }
    function logout() { sessionStorage.removeItem('l'); location.reload(); }
    function show() { document.getElementById('loginOverlay').style.display='none'; document.getElementById('adminContent').style.display='block'; render(); }
    
    function save() {
      const idx = document.getElementById('editIdx').value;
      const p = { name: document.getElementById('pN').value, price: document.getElementById('pP').value, desc: document.getElementById('pD').value, img: document.getElementById('pI').value };
      let items = JSON.parse(localStorage.getItem('candyProducts')) || [];
      if(idx == -1) items.push(p); else items[idx] = p;
      localStorage.setItem('candyProducts', JSON.stringify(items));
      location.reload();
    }

    function edit(i) {
      const items = JSON.parse(localStorage.getItem('candyProducts'));
      document.getElementById('editIdx').value = i;
      document.getElementById('pN').value = items[i].name;
      document.getElementById('pP').value = items[i].price;
      document.getElementById('pD').value = items[i].desc;
      document.getElementById('pI').value = items[i].img;
      document.getElementById('formT').innerText = "Edytuj";
    }

    function del(i, type) {
      let k = type == 'p' ? 'candyProducts' : 'candyOrders';
      let items = JSON.parse(localStorage.getItem(k));
      items.splice(i, 1);
      localStorage.setItem(k, JSON.stringify(items));
      render();
    }

    function exportData() {
      const data = { p: localStorage.getItem('candyProducts'), o: localStorage.getItem('candyOrders') };
      const blob = new Blob([JSON.stringify(data)], {type: 'application/json'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'backup.json'; a.click();
    }

    function render() {
      const q = document.getElementById('search').value.toLowerCase();
      const ps = JSON.parse(localStorage.getItem('candyProducts')) || [];
      const os = JSON.parse(localStorage.getItem('candyOrders')) || [];
      document.getElementById('s1').innerText = ps.length;
      document.getElementById('s2').innerText = os.length;
      
      let hP = ""; ps.forEach((p, i) => { if(p.name.toLowerCase().includes(q)) hP += `<tr><td><img src="${p.img}" class="img-p"></td><td>${p.name}</td><td><button onclick="edit(${i})">‚úèÔ∏è</button> <button onclick="del(${i}, 'p')">üóëÔ∏è</button></td></tr>`; });
      document.getElementById('pList').innerHTML = hP;

      let hO = ""; os.forEach((o, i) => { if(o.customer.toLowerCase().includes(q) || o.product.toLowerCase().includes(q)) hO += `<tr><td>${o.date}</td><td style="color:var(--pink); cursor:pointer;" onclick="navigator.clipboard.writeText('${o.customer}')">üìã ${o.customer}</td><td>${o.product}</td><td>${o.message}</td><td><button onclick="del(${i}, 'o')">Usu≈Ñ</button></td></tr>`; });
      document.getElementById('oList').innerHTML = hO;
    }
    window.onload = () => { if(sessionStorage.getItem('l')) show(); };
  </script>
</body>
</html>
